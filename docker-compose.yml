version: '3.8'

services:
  live_server:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        ENV: prod
    image: ${DOCKERHUB_USERNAME:-daheepk}/live_server:latest
    ports:
      - "8080:8080"
    environment:
      SPRING_PROFILES_ACTIVE: prod
      SPRING_DATASOURCE_DB1_PROD_JDBC_URL: ${APPLICATION_SPRING_DATASOURCE_DB1_PROD_JDBC_URL}
      SPRING_DATASOURCE_DB2_PROD_JDBC_URL: ${APPLICATION_SPRING_DATASOURCE_DB2_PROD_JDBC_URL}
      KAKAO_CLIENT_ID: ${APPLICATION_KAKAO_CLIENT_ID}
      KAKAO_REDIRECT_URI: ${APPLICATION_KAKAO_PROD_REDIRECT_URI}
      SPRING_DATASOURCE_DB1_USERNAME: ${APPLICATION_SPRING_DATASOURCE_DB1_USERNAME}
      SPRING_DATASOURCE_DB1_PASSWORD: ${APPLICATION_SPRING_DATASOURCE_DB1_PASSWORD}
      SPRING_DATASOURCE_DB2_USERNAME: ${APPLICATION_SPRING_DATASOURCE_DB2_USERNAME}
      SPRING_DATASOURCE_DB2_PASSWORD: ${APPLICATION_SPRING_DATASOURCE_DB2_PASSWORD}
    env_file:
      - .env